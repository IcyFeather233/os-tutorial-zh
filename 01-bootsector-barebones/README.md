*你可能想事先谷歌的概念：汇编器，BIOS*

**目标：创建一个BIOS解释为可启动磁盘的文件**

这非常令人兴奋，我们将创建自己的引导扇区！

理论
------

当计算机启动时，BIOS不知道如何加载操作系统，因此它将该任务委托给引导扇区。因此，引导扇区必须放置在一个已知的标准位置。该位置是磁盘的第一个扇区（柱面0，磁头0，扇区0），它占用512字节。

为了确保“磁盘是可启动的”，BIOS检查所谓的引导扇区的字节511和512是否为字节`0xAA55`。

这是有史以来最简单的引导扇区：

```
e9 fd ff 00 00 00 00 00 00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
[ 29 更多行，每行十六个零字节 ]
00 00 00 00 00 00 00 00 00 00 00 00 00 00 55 aa
```

它基本上全是零，结尾是16位值`0xAA55`（注意字节序，x86是小端序）。前三个字节执行一个无限跳转。

有史以来最简单的引导扇区
-------------------------

你可以用二进制编辑器编写上述512字节，或者只写一个非常简单的汇编代码：

```nasm
; 无限循环 (e9 fd ff)
loop:
    jmp loop 

; 用510个零填充，减去前面代码的大小
times 510-($-$$) db 0
; 魔数
dw 0xaa55 
```

```
$ - 表示当前指令的地址。

$$ - 表示当前代码段的起始地址。

$-$$ - 表示当前指令相对于代码段起始地址的偏移量。

510-($-$$) - 表示需要填充的字节数，使得总长度达到510字节。
```

编译：
`nasm -f bin boot_sect_simple.asm -o boot_sect_simple.bin`

> OSX警告：如果这抛出错误，请再次阅读第00章

我知道你迫不及待想试试（我也是！），所以让我们来做吧：

`qemu boot_sect_simple.bin`

> 在某些系统上，你可能需要运行 `qemu-system-x86_64 boot_sect_simple.bin`。如果这给出SDL错误，尝试传递 --nographic 和/或 --curses 标志。

你会看到一个窗口打开，上面写着“Booting from Hard Disk...”，然后什么也没有。上次你看到无限循环时有多兴奋？ ;-)